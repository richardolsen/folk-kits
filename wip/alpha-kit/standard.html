<!DOCTYPE html>
<script>
  let code = "";
  let id = 0
  let title = ""
</script>
<script src="https://cdn.jsdelivr.net/npm/apriltag@latest/dist/browser.js"></script>
<style>
  @page {
    size: A4;
    margin: 50;
  }
  @media print {
    html, body {
      width: 210mm;
      height: 297mm;
    }
   
  }
  body {
        position: relative;
    }
    body #apriltag1 {
        position: absolute;
        top: 0px;
        right: 0px;
    }
</style>

<body>
  <div id="apriltag1">
    <svg id="tag1" viewBox="0 0 100 100" width="200" height="200" xmlns="http://www.w3.org/2000/svg"></svg>
    <div id="tag1id"></div>
    <div id="created1">Created: </div>
  </div>
  <div><h3 id="title1"></h3></div>
  <div id="code1"></div>

  <script>
  async function main() {
    const rsp = await fetch('https://cdn.jsdelivr.net/npm/apriltag@latest/families/standard52h13.json')
    const tagStandard52h13 = await rsp.json()

    const family = new AprilTagFamily(tagStandard52h13)
    tag = family.render(id)
    console.log(tag)
    for(r=0; r<tag.length;r++){
      for(c=0; c<tag[r].length;c++){
        let newElement = document.createElementNS('http://www.w3.org/2000/svg','rect');
        if ( tag[r][c] == 'b'){
          newElement.setAttribute('fill','black'); 
        } else {
          newElement.setAttribute('fill','white');
        }
        newElement.setAttribute('width','10');
        newElement.setAttribute('height','10');
        newElement.setAttribute('x',c*10);
        newElement.setAttribute('y',r*10);
        document.getElementById('tag1').appendChild(newElement);
      }
    }
    
  }

  main()
  let myDiv = document.getElementById('code1')
  newCode = code.split('\n').map((line, index) => `${index + 1}. ${line}`).join('<br />');
  myDiv.innerHTML = newCode;

  let theTitle = document.getElementById('title1')
  theTitle.innerHTML = title;

  let theTagId= document.getElementById('tag1id')
  theTagId.innerHTML = "Program id: "+id;

  let createdDate = document.getElementById('created1')
  const d = new Date();
  let textDate = d.toDateString();
  let textTime = d.toLocaleTimeString();
  createdDate.innerHTML = "Updated: "+textDate+" "+textTime
</script>
</body>
</html>